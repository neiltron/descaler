import{s as G,n as V,c as U,o as ne,f as A,r as J,e as Y}from"../chunks/scheduler.jEsUqNkz.js";import{S as K,i as z,e as b,s as D,m as S,c as C,a as O,d as w,f as E,g as I,y as x,z as R,o as _,h as v,u as le,v as ae,w as se,k as re,l as oe,x as ie}from"../chunks/index.XqvLI3xT.js";import{w as B}from"../chunks/index.1Vp6x_fP.js";const j=B(!1),X=B(!1),M=B(null),Q=B(null);function W(r){let e,l,t,a,s,h="Select an image",n,o,d;function p(f,m){return f[2]?ce:de}let k=p(r),c=k(r);return{c(){e=b("div"),l=b("form"),t=b("input"),a=D(),s=b("label"),s.textContent=h,n=D(),c.c(),this.h()},l(f){e=C(f,"DIV",{id:!0,role:!0,tabindex:!0,class:!0});var m=O(e);l=C(m,"FORM",{});var y=O(l);t=C(y,"INPUT",{class:!0,type:!0,id:!0,accept:!0,title:!0}),a=E(y),s=C(y,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),R(s)!=="svelte-7ddtkq"&&(s.textContent=h),y.forEach(w),n=E(m),c.l(m),m.forEach(w),this.h()},h(){_(t,"class","hidden svelte-y2hrr0"),_(t,"type","file"),_(t,"id","file"),_(t,"accept","image/*"),_(t,"title","Upload an image"),_(s,"for","file"),_(s,"class","svelte-y2hrr0"),_(e,"id","dropzone"),_(e,"role","button"),_(e,"tabindex","0"),_(e,"class","border-2 border-dashed border-gray-400 hover:border-gray-500 rounded-lg p-4 text-center svelte-y2hrr0")},m(f,m){I(f,e,m),v(e,l),v(l,t),v(l,a),v(l,s),v(e,n),c.m(e,null),r[9](e),o||(d=[x(t,"change",r[4]),x(e,"dragover",r[6]),x(e,"drop",r[5]),x(e,"click",me)],o=!0)},p(f,m){k!==(k=p(f))&&(c.d(1),c=k(f),c&&(c.c(),c.m(e,null)))},d(f){f&&w(e),c.d(),r[9](null),o=!1,J(d)}}}function ce(r){let e,l="Drop it";return{c(){e=b("p"),e.textContent=l,this.h()},l(t){e=C(t,"P",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-16wvdra"&&(e.textContent=l),this.h()},h(){_(e,"class","mt-0.5 svelte-y2hrr0")},m(t,a){I(t,e,a)},d(t){t&&w(e)}}}function de(r){let e,l="Or drop one here";return{c(){e=b("p"),e.textContent=l,this.h()},l(t){e=C(t,"P",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-1995ugg"&&(e.textContent=l),this.h()},h(){_(e,"class","mt-0.5 svelte-y2hrr0")},m(t,a){I(t,e,a)},d(t){t&&w(e)}}}function fe(r){let e,l,t,a,s,h,n=!r[3]&&W(r);return{c(){e=b("canvas"),t=D(),n&&n.c(),a=S(),this.h()},l(o){e=C(o,"CANVAS",{}),O(e).forEach(w),t=E(o),n&&n.l(o),a=S(),this.h()},h(){e.hidden=l=!r[3]},m(o,d){I(o,e,d),r[8](e),I(o,t,d),n&&n.m(o,d),I(o,a,d),s||(h=x(e,"mousemove",r[7]),s=!0)},p(o,[d]){d&8&&l!==(l=!o[3])&&(e.hidden=l),o[3]?n&&(n.d(1),n=null):n?n.p(o,d):(n=W(o),n.c(),n.m(a.parentNode,a))},i:V,o:V,d(o){o&&(w(e),w(t),w(a)),r[8](null),n&&n.d(o),s=!1,h()}}}let ue=1e-6,he=40;function me(){const r=document.getElementById("file");r==null||r.click()}function pe(r,e,l){let t,a,s,h;U(r,M,i=>l(1,t=i)),U(r,Q,i=>l(11,a=i)),U(r,X,i=>l(2,s=i)),U(r,j,i=>l(3,h=i));let n=null,o;function d(i){if(i&&i.type.startsWith("image/")){const g=new FileReader;g.onload=u=>{var L;n=new Image,n.onload=()=>f(),n.src=(L=u.target)==null?void 0:L.result},g.readAsDataURL(i),A(j,h=!0,h)}}function p(i){var u;const g=(u=i.target)==null?void 0:u.files[0];d(g)}function k(i){var u;i.preventDefault();const g=(u=i.dataTransfer)==null?void 0:u.files[0];g&&d(g)}function c(i){i.preventDefault(),A(X,s=i.type==="dragover",s),o.classList.toggle("border-stone-500",s)}function f(){if(!t||!n)return;let i,g,u;n.width>800?(i=800/n.width,g=800,u=n.height*i):(i=1,g=n.width,u=n.height),A(M,t.width=g,t),A(M,t.height=u,t),a==null||a.drawImage(n,0,0,g,u)}function m(i,g,u,L){const T=i-u/2,F=g-u/2,H=a==null?void 0:a.getImageData(T,F,u,u);if(!H)return;const N=document.createElement("canvas");N.width=u,N.height=u;const P=N.getContext("2d");P==null||P.putImageData(H,0,0);const te=N.toDataURL("image/jpeg",L),q=new Image;q.onload=function(){a==null||a.clearRect(T,F,u,u),a==null||a.drawImage(q,T,F,u,u)},q.src=te}ne(()=>{A(Q,a=t==null?void 0:t.getContext("2d"),a),window.addEventListener("dragover",c),window.addEventListener("dragleave",c),window.addEventListener("drop",k)});function y(i){if(i.buttons!==1)return;const g=t==null?void 0:t.getBoundingClientRect();if(!g)return;const u=Math.floor(i.clientX-g.left),L=Math.floor(i.clientY-g.top);m(u,L,he,ue)}function $(i){Y[i?"unshift":"push"](()=>{t=i,M.set(t)})}function ee(i){Y[i?"unshift":"push"](()=>{o=i,l(0,o)})}return[o,t,s,h,p,k,c,y,$,ee]}class ge extends K{constructor(e){super(),z(this,e,pe,fe,G,{})}}function Z(r){let e,l,t="Reset",a,s,h="Save image",n,o;return{c(){e=b("div"),l=b("button"),l.textContent=t,a=D(),s=b("button"),s.textContent=h,this.h()},l(d){e=C(d,"DIV",{});var p=O(e);l=C(p,"BUTTON",{class:!0,"data-svelte-h":!0}),R(l)!=="svelte-p8h5vl"&&(l.textContent=t),a=E(p),s=C(p,"BUTTON",{class:!0,"data-svelte-h":!0}),R(s)!=="svelte-kqrxpm"&&(s.textContent=h),p.forEach(w),this.h()},h(){_(l,"class","btn btn-gray svelte-1xpnjzx"),_(s,"class","btn btn-gray svelte-1xpnjzx")},m(d,p){I(d,e,p),v(e,l),v(e,a),v(e,s),n||(o=[x(l,"click",r[2]),x(s,"click",r[3])],n=!0)},p:V,d(d){d&&w(e),n=!1,J(o)}}}function _e(r){let e,l,t="Descaler",a,s,h,n="Drawing with compression.",o,d,p,k,c=r[0]&&Z(r);return p=new ge({}),{c(){e=b("main"),l=b("h1"),l.textContent=t,a=D(),s=b("nav"),h=b("h2"),h.textContent=n,o=D(),c&&c.c(),d=D(),le(p.$$.fragment),this.h()},l(f){e=C(f,"MAIN",{class:!0});var m=O(e);l=C(m,"H1",{class:!0,"data-svelte-h":!0}),R(l)!=="svelte-hk1zpg"&&(l.textContent=t),a=E(m),s=C(m,"NAV",{class:!0});var y=O(s);h=C(y,"H2",{"data-svelte-h":!0}),R(h)!=="svelte-qd8s7g"&&(h.textContent=n),o=E(y),c&&c.l(y),y.forEach(w),d=E(m),ae(p.$$.fragment,m),m.forEach(w),this.h()},h(){_(l,"class","text-3xl font-bold "),_(s,"class","mb-2 text-sm flex justify-between items-center"),_(e,"class","svelte-1xpnjzx")},m(f,m){I(f,e,m),v(e,l),v(e,a),v(e,s),v(s,h),v(s,o),c&&c.m(s,null),v(e,d),se(p,e,null),k=!0},p(f,[m]){f[0]?c?c.p(f,m):(c=Z(f),c.c(),c.m(s,null)):c&&(c.d(1),c=null)},i(f){k||(re(p.$$.fragment,f),k=!0)},o(f){oe(p.$$.fragment,f),k=!1},d(f){f&&w(e),c&&c.d(),ie(p)}}}function ve(r,e,l){let t,a;return U(r,j,n=>l(0,t=n)),U(r,M,n=>l(1,a=n)),[t,a,()=>j.set(!1),()=>a==null?void 0:a.toBlob(n=>{if(!n)return;const o=URL.createObjectURL(n),d=document.createElement("a");d.href=o,d.download="descaler.png",d.click(),URL.revokeObjectURL(o)})]}class ke extends K{constructor(e){super(),z(this,e,ve,_e,G,{})}}export{ke as component};
