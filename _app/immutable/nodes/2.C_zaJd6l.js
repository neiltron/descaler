import{s as G,n as V,c as U,o as ne,f as O,r as J,e as Y}from"../chunks/scheduler.jEsUqNkz.js";import{S as K,i as z,e as b,s as D,m as S,c as C,a as M,d as w,f as E,g as I,y as x,z as R,o as g,h as v,u as ae,v as le,w as se,k as re,l as oe,x as ie}from"../chunks/index.XqvLI3xT.js";import{w as B}from"../chunks/index.1Vp6x_fP.js";const j=B(!1),X=B(!1),A=B(null),Q=B(null);function W(r){let e,n,t,a,s,u="Select an image",l,o,d;function p(f,h){return f[2]?ce:de}let k=p(r),c=k(r);return{c(){e=b("div"),n=b("form"),t=b("input"),a=D(),s=b("label"),s.textContent=u,l=D(),c.c(),this.h()},l(f){e=C(f,"DIV",{id:!0,role:!0,tabindex:!0,class:!0});var h=M(e);n=C(h,"FORM",{});var y=M(n);t=C(y,"INPUT",{class:!0,type:!0,id:!0,accept:!0,title:!0}),a=E(y),s=C(y,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),R(s)!=="svelte-7ddtkq"&&(s.textContent=u),y.forEach(w),l=E(h),c.l(h),h.forEach(w),this.h()},h(){g(t,"class","hidden svelte-y2hrr0"),g(t,"type","file"),g(t,"id","file"),g(t,"accept","image/*"),g(t,"title","Upload an image"),g(s,"for","file"),g(s,"class","svelte-y2hrr0"),g(e,"id","dropzone"),g(e,"role","button"),g(e,"tabindex","0"),g(e,"class","border-2 border-dashed border-gray-400 hover:border-gray-500 rounded-lg p-4 text-center svelte-y2hrr0")},m(f,h){I(f,e,h),v(e,n),v(n,t),v(n,a),v(n,s),v(e,l),c.m(e,null),r[9](e),o||(d=[x(t,"change",r[4]),x(e,"dragover",r[6]),x(e,"drop",r[5]),x(e,"click",me)],o=!0)},p(f,h){k!==(k=p(f))&&(c.d(1),c=k(f),c&&(c.c(),c.m(e,null)))},d(f){f&&w(e),c.d(),r[9](null),o=!1,J(d)}}}function ce(r){let e,n="Drop it";return{c(){e=b("p"),e.textContent=n,this.h()},l(t){e=C(t,"P",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-16wvdra"&&(e.textContent=n),this.h()},h(){g(e,"class","mt-0.5 svelte-y2hrr0")},m(t,a){I(t,e,a)},d(t){t&&w(e)}}}function de(r){let e,n="Or drop one here";return{c(){e=b("p"),e.textContent=n,this.h()},l(t){e=C(t,"P",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-1995ugg"&&(e.textContent=n),this.h()},h(){g(e,"class","mt-0.5 svelte-y2hrr0")},m(t,a){I(t,e,a)},d(t){t&&w(e)}}}function fe(r){let e,n,t,a,s,u,l=!r[3]&&W(r);return{c(){e=b("canvas"),t=D(),l&&l.c(),a=S(),this.h()},l(o){e=C(o,"CANVAS",{}),M(e).forEach(w),t=E(o),l&&l.l(o),a=S(),this.h()},h(){e.hidden=n=!r[3]},m(o,d){I(o,e,d),r[8](e),I(o,t,d),l&&l.m(o,d),I(o,a,d),s||(u=x(e,"mousemove",r[7]),s=!0)},p(o,[d]){d&8&&n!==(n=!o[3])&&(e.hidden=n),o[3]?l&&(l.d(1),l=null):l?l.p(o,d):(l=W(o),l.c(),l.m(a.parentNode,a))},i:V,o:V,d(o){o&&(w(e),w(t),w(a)),r[8](null),l&&l.d(o),s=!1,u()}}}let ue=1e-6,he=40;function me(){const r=document.getElementById("file");r==null||r.click()}function pe(r,e,n){let t,a,s,u;U(r,A,i=>n(1,t=i)),U(r,Q,i=>n(11,a=i)),U(r,X,i=>n(2,s=i)),U(r,j,i=>n(3,u=i));let l=null,o;function d(i){if(i&&i.type.startsWith("image/")){const _=new FileReader;_.onload=m=>{var L;l=new Image,l.onload=()=>f(),l.src=(L=m.target)==null?void 0:L.result},_.readAsDataURL(i),O(j,u=!0,u)}}function p(i){var m;const _=(m=i.target)==null?void 0:m.files[0];d(_)}function k(i){var m;i.preventDefault();const _=(m=i.dataTransfer)==null?void 0:m.files[0];_&&d(_)}function c(i){i.preventDefault(),O(X,s=i.type==="dragover",s),o.classList.toggle("border-stone-500",s)}function f(){if(!t||!l)return;const i=800/l.width,_=Math.min(800,l.width);O(A,t.width=_,t),O(A,t.height=l.height*i,t),a==null||a.drawImage(l,0,0,t.width,t.height)}function h(i,_,m,L){const T=i-m/2,F=_-m/2,H=a==null?void 0:a.getImageData(T,F,m,m);if(!H)return;const N=document.createElement("canvas");N.width=m,N.height=m;const P=N.getContext("2d");P==null||P.putImageData(H,0,0);const te=N.toDataURL("image/jpeg",L),q=new Image;q.onload=function(){a==null||a.clearRect(T,F,m,m),a==null||a.drawImage(q,T,F,m,m)},q.src=te}ne(()=>{O(Q,a=t==null?void 0:t.getContext("2d"),a),window.addEventListener("dragover",c),window.addEventListener("dragleave",c),window.addEventListener("drop",k)});function y(i){if(i.buttons!==1)return;const _=t==null?void 0:t.getBoundingClientRect();if(!_)return;const m=Math.floor(i.clientX-_.left),L=Math.floor(i.clientY-_.top);h(m,L,he,ue)}function $(i){Y[i?"unshift":"push"](()=>{t=i,A.set(t)})}function ee(i){Y[i?"unshift":"push"](()=>{o=i,n(0,o)})}return[o,t,s,u,p,k,c,y,$,ee]}class ge extends K{constructor(e){super(),z(this,e,pe,fe,G,{})}}function Z(r){let e,n,t="Reset",a,s,u="Save image",l,o;return{c(){e=b("div"),n=b("button"),n.textContent=t,a=D(),s=b("button"),s.textContent=u,this.h()},l(d){e=C(d,"DIV",{});var p=M(e);n=C(p,"BUTTON",{class:!0,"data-svelte-h":!0}),R(n)!=="svelte-p8h5vl"&&(n.textContent=t),a=E(p),s=C(p,"BUTTON",{class:!0,"data-svelte-h":!0}),R(s)!=="svelte-kqrxpm"&&(s.textContent=u),p.forEach(w),this.h()},h(){g(n,"class","btn btn-gray svelte-1xpnjzx"),g(s,"class","btn btn-gray svelte-1xpnjzx")},m(d,p){I(d,e,p),v(e,n),v(e,a),v(e,s),l||(o=[x(n,"click",r[2]),x(s,"click",r[3])],l=!0)},p:V,d(d){d&&w(e),l=!1,J(o)}}}function _e(r){let e,n,t="Descaler",a,s,u,l="Drawing with compression.",o,d,p,k,c=r[0]&&Z(r);return p=new ge({}),{c(){e=b("main"),n=b("h1"),n.textContent=t,a=D(),s=b("nav"),u=b("h2"),u.textContent=l,o=D(),c&&c.c(),d=D(),ae(p.$$.fragment),this.h()},l(f){e=C(f,"MAIN",{class:!0});var h=M(e);n=C(h,"H1",{class:!0,"data-svelte-h":!0}),R(n)!=="svelte-hk1zpg"&&(n.textContent=t),a=E(h),s=C(h,"NAV",{class:!0});var y=M(s);u=C(y,"H2",{"data-svelte-h":!0}),R(u)!=="svelte-qd8s7g"&&(u.textContent=l),o=E(y),c&&c.l(y),y.forEach(w),d=E(h),le(p.$$.fragment,h),h.forEach(w),this.h()},h(){g(n,"class","text-3xl font-bold "),g(s,"class","mb-2 text-sm flex justify-between items-center"),g(e,"class","svelte-1xpnjzx")},m(f,h){I(f,e,h),v(e,n),v(e,a),v(e,s),v(s,u),v(s,o),c&&c.m(s,null),v(e,d),se(p,e,null),k=!0},p(f,[h]){f[0]?c?c.p(f,h):(c=Z(f),c.c(),c.m(s,null)):c&&(c.d(1),c=null)},i(f){k||(re(p.$$.fragment,f),k=!0)},o(f){oe(p.$$.fragment,f),k=!1},d(f){f&&w(e),c&&c.d(),ie(p)}}}function ve(r,e,n){let t,a;return U(r,j,l=>n(0,t=l)),U(r,A,l=>n(1,a=l)),[t,a,()=>j.set(!1),()=>a==null?void 0:a.toBlob(l=>{if(!l)return;const o=URL.createObjectURL(l),d=document.createElement("a");d.href=o,d.download="descaler.png",d.click(),URL.revokeObjectURL(o)})]}class ke extends K{constructor(e){super(),z(this,e,ve,_e,G,{})}}export{ke as component};
